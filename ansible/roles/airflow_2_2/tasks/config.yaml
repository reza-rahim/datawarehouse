- name: copy  airflow config files
  template: src='{{ item.src }}' dest='{{ item.dest }}' owner='{{ airflow_user }}'  group='{{ application_group }}' mode=0750
  loop:
     - { src: 'airflow.cfg.j2', dest: '{{ airflow_home }}/airflow.cfg'  }
     - { src: 'run-airflow-scheduler.sh.j2', dest: '{{ airflow_home }}/run-airflow-scheduler.sh'  }
     - { src: 'run-airflow-webserver.sh.j2', dest: '{{ airflow_home }}/run-airflow-webserver.sh'  }
     - { src: 'airflow-scheduler.service.j2', dest: '/etc/systemd/system/airflow-scheduler.service'  }
     - { src: 'airflow-webserver.service.j2', dest: '/etc/systemd/system/airflow-webserver.service'  }
  notify:
    - restart airflow_scheduler
    - restart airflow_webserver
     
# Reload systemd to recognize the new service definition
- name: Reload systemd daemon
  systemd:
    daemon_reload: true       
